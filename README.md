Это явно не тот код, которым я могу гордиться, но это таки что-то
